package com.redhat.ecosystemappeng.model;

import java.util.Date;
import java.util.List;

import com.redhat.ecosystemappeng.model.nvd.Metrics;
import com.redhat.ecosystemappeng.model.osv.Affected;

public record Vulnerability(
        List<String> aliases,
        String cveId,
        Date created,
        Date lastModified,
        String summary,
        String description,
        List<Affected> affected,
        Metrics metrics) {

    public boolean hasData() {
        return created != null && metrics != null;
    }

    public static class Builder {
        List<String> aliases;
        String cveId;
        Date created;
        Date lastModified;
        String summary;
        String description;
        List<Affected> affected;
        Metrics metrics;

        public Builder() {
        }

        public Builder(Vulnerability other) {
            this.aliases = other.aliases;
            this.cveId = other.cveId;
            this.created = other.created;
            this.lastModified = other.lastModified;
            this.summary = other.summary;
            this.description = other.description;
            this.affected = other.affected;
            this.metrics = other.metrics;
        }

        public Builder aliases(List<String> aliases) {
            this.aliases = aliases;
            return this;
        }

        public Builder cveId(String cveId) {
            this.cveId = cveId;
            return this;
        }

        public Builder created(Date created) {
            this.created = created;
            return this;
        }

        public Builder lastModified(Date lastModified) {
            this.lastModified = lastModified;
            return this;
        }

        public Builder summary(String summary) {
            this.summary = summary;
            return this;
        }

        public Builder description(String description) {
            this.description = description;
            return this;
        }

        public Builder affected(List<Affected> affected) {
            this.affected = affected;
            return this;
        }

        public Builder metrics(Metrics metrics) {
            this.metrics = metrics;
            return this;
        }

        public String getCveId() {
            return cveId;
        }

        public List<String> getAliases() {
            return aliases;
        }
        
        public Vulnerability build() {
            return new Vulnerability(aliases, cveId, created, lastModified, summary, description, affected, metrics);
        }


    }
}
