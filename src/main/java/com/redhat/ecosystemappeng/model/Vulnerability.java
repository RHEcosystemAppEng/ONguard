package com.redhat.ecosystemappeng.model;

import java.util.Date;

import com.fasterxml.jackson.databind.JsonNode;

public record Vulnerability(
        String vulnId,
        String cveId,
        Date created,
        Date lastModified,
        JsonNode nvdData) {

    public boolean exists() {
        return created != null;
    }

    public static class Builder {
        String vulnId;
        String cveId;
        Date created;
        Date lastModified;
        JsonNode nvdData;

        public Builder() {}

        public Builder(Vulnerability other) {
            this.vulnId = other.vulnId;
            this.cveId = other.cveId;
            this.created = other.created;
            this.lastModified = other.lastModified;
            this.nvdData = other.nvdData;
        }

        public Builder vulnId(String vulnId) {
            this.vulnId = vulnId;
            return this;
        }

        public Builder created(Date created) {
            this.created = created;
            return this;
        }

        public Builder lastModified(Date lastModified) {
            this.lastModified = lastModified;
            return this;
        }

        public Builder cveId(String cveId) {
            this.cveId = cveId;
            return this;
        }

        public Builder nvdData(JsonNode nvdData) {
            this.nvdData = nvdData;
            return this;
        }

        public String getVulnId() {
            return this.vulnId;
        }

        public String getCveId() {
            return this.cveId;
        }

        public Date getCreated() {
            return this.created;
        }

        public Date getLastModified() {
            return this.lastModified;
        }

        public JsonNode getNvdData() {
            return this.nvdData;
        }

        public Vulnerability build() {
            return new Vulnerability(vulnId, cveId, created, lastModified, nvdData);
        }

    }
}
