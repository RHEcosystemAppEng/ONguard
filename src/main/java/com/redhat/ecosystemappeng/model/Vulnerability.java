package com.redhat.ecosystemappeng.model;

import org.bson.Document;
import org.bson.codecs.pojo.annotations.BsonProperty;

import io.quarkus.mongodb.panache.common.MongoEntity;

@MongoEntity(collection = "osv-vulnerabilies", database = "exhort")
public record Vulnerability(
        @BsonProperty("_id") String cveId,
        Document cve) {

    public static class Builder {
        String cveId;
        Document cve;

        public Builder cveId(String cveId) {
            this.cveId = cveId;
            return this;
        }

        public Builder cve(Document cve) {
            this.cve = cve;
            return this;
        }

        public Vulnerability build() {
            return new Vulnerability(cveId, cve);
        }

    }
}
