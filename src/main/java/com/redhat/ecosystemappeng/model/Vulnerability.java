package com.redhat.ecosystemappeng.model;

import java.util.Date;
import java.util.List;

import com.fasterxml.jackson.databind.JsonNode;

public record Vulnerability(
        List<String> aliases,
        String cveId,
        Date created,
        Date lastModified,
        JsonNode nvdData) {

    public boolean exists() {
        return created != null;
    }

    public static class Builder {
        List<String> aliases;
        String cveId;
        Date created;
        Date lastModified;
        JsonNode nvdData;

        public Builder() {}

        public Builder(Vulnerability other) {
            this.aliases = other.aliases;
            this.cveId = other.cveId;
            this.created = other.created;
            this.lastModified = other.lastModified;
            this.nvdData = other.nvdData;
        }

        public Builder aliases(List<String> aliases) {
            this.aliases = aliases;
            return this;
        }

        public Builder created(Date created) {
            this.created = created;
            return this;
        }

        public Builder lastModified(Date lastModified) {
            this.lastModified = lastModified;
            return this;
        }

        public Builder cveId(String cveId) {
            this.cveId = cveId;
            return this;
        }

        public Builder nvdData(JsonNode nvdData) {
            this.nvdData = nvdData;
            return this;
        }

        public List<String> getAliases() {
            return this.aliases;
        }

        public String getCveId() {
            return this.cveId;
        }

        public Date getCreated() {
            return this.created;
        }

        public Date getLastModified() {
            return this.lastModified;
        }

        public JsonNode getNvdData() {
            return this.nvdData;
        }

        public Vulnerability build() {
            return new Vulnerability(aliases, cveId, created, lastModified, nvdData);
        }

    }
}
